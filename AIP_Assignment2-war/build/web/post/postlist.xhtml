<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:composition template="../share/_layout.xhtml">
        <ui:define name="title">
            Flat Mate Finder
        </ui:define>
        <ui:define name="style">
            <style>
                .postcss thead th{
                    font-size: small;
                    text-align: left;
                }
                .postcss tr td{ 
                    width: 250px;
                }
                .postcss tr td:nth-child(2){ 
                    width: 350px;
                }
            </style>
        </ui:define>
        <ui:define name="content">
            <h2>Flat Mate Finder</h2>

            <h:form>
                
                <h:selectOneMenu value="#{postController.showType}" 
                                 rendered="#{subscriptionController.serviceType() == 'premium'}">
                    <f:selectItem itemLabel="Select..." />
                    <f:selectItem itemValue="all" />
                    <f:selectItem itemValue="Looking for room" />
                    <f:selectItem itemValue="Looking for flatmate" />
                    <f:ajax render="@form" />
                </h:selectOneMenu>

                <!--Show below when premium user want to check all post-->
                <h:panelGroup rendered="#{postController.showType == 'all'}">
                    <h:dataTable var="posts" value="#{postController.allStickyPosts}" 
                                 styleClass="postcss">
                        <h:column>
                            <f:facet name="header">
                                Type
                            </f:facet>
                            <h:outputText value="#{posts.posttype.label}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                Subject
                            </f:facet>
                            <h:link value="#{posts.subject}" outcome="postdetail?pid=#{posts.id}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                Author
                            </f:facet>
                            <h:outputText value="#{posts.user.firstName}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                Post Date
                            </f:facet>
                            <h:outputText value="#{posts.postdate}"/>
                        </h:column>
                    </h:dataTable>
                    <hr/>
                    <h:dataTable var="posts" value="#{postController.allRegularPosts}"
                                 styleClass="postcss">
                        <h:column>
                            <f:facet name="header">
                            </f:facet>
                            <h:outputText value="#{posts.posttype.label}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                            </f:facet>
                            <h:link value="#{posts.subject}" outcome="postdetail?pid=#{posts.id}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">

                            </f:facet>
                            <h:outputText value="#{posts.user.firstName}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                            </f:facet>
                            <h:outputText value="#{posts.postdate}"/>
                        </h:column>
                    </h:dataTable>
                </h:panelGroup>
                
                <!--Show below if premium user want to check only rentin-->
                <h:panelGroup rendered="#{postController.showType == 'Looking for room'}">
                    <h:dataTable var="posts" value="#{postController.allRentinStickyPosts}" 
                                 styleClass="postcss">
                        <h:column>
                            <f:facet name="header">
                                Type
                            </f:facet>
                            <h:outputText value="#{posts.posttype.label}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                Subject
                            </f:facet>
                            <h:link value="#{posts.subject}" outcome="postdetail?pid=#{posts.id}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                Author
                            </f:facet>
                            <h:outputText value="#{posts.user.firstName}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                Post Date
                            </f:facet>
                            <h:outputText value="#{posts.postdate}"/>
                        </h:column>
                    </h:dataTable>
                    <hr/>
                    <h:dataTable var="posts" value="#{postController.allRentinRegularPosts}"
                                 styleClass="postcss">
                        <h:column>
                            <f:facet name="header">
                            </f:facet>
                            <h:outputText value="#{posts.posttype.label}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                            </f:facet>
                            <h:link value="#{posts.subject}" outcome="postdetail?pid=#{posts.id}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">

                            </f:facet>
                            <h:outputText value="#{posts.user.firstName}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                            </f:facet>
                            <h:outputText value="#{posts.postdate}"/>
                        </h:column>
                    </h:dataTable>
                </h:panelGroup>

                <!--Show below when premium user want to check flatmate rent-->
                <h:panelGroup rendered="#{postController.showType == 'Looking for flatmate'}">
                    <h:dataTable var="posts" value="#{postController.allRentoutStickyPosts}" 
                                 styleClass="postcss">
                        <h:column>
                            <f:facet name="header">
                                Type
                            </f:facet>
                            <h:outputText value="#{posts.posttype.label}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                Subject
                            </f:facet>
                            <h:link value="#{posts.subject}" outcome="postdetail?pid=#{posts.id}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                Author
                            </f:facet>
                            <h:outputText value="#{posts.user.firstName}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                Post Date
                            </f:facet>
                            <h:outputText value="#{posts.postdate}"/>
                        </h:column>
                    </h:dataTable>
                    <hr/>
                    <h:dataTable var="posts" value="#{postController.allRentoutRegularPosts}"
                                 styleClass="postcss">
                        <h:column>
                            <f:facet name="header">
                            </f:facet>
                            <h:outputText value="#{posts.posttype.label}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                            </f:facet>
                            <h:link value="#{posts.subject}" outcome="postdetail?pid=#{posts.id}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">

                            </f:facet>
                            <h:outputText value="#{posts.user.firstName}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                            </f:facet>
                            <h:outputText value="#{posts.postdate}"/>
                        </h:column>
                    </h:dataTable>
                </h:panelGroup>
            </h:form>
            
            <!--Show below when user service is free and standard-->
            <h:dataTable var="posts" value="#{postController.allStickyPosts}" 
                         styleClass="postcss"
                         rendered="#{subscriptionController.serviceType() == 'free' or 
                                     subscriptionController.serviceType() == 'standard'}">
                <h:column>
                    <f:facet name="header">
                        Type
                    </f:facet>
                    <h:outputText value="#{posts.posttype.label}"/>
                </h:column>
                <h:column>
                    <f:facet name="header">
                        Subject
                    </f:facet>
                    <h:link value="#{posts.subject}" outcome="postdetail?pid=#{posts.id}"/>
                </h:column>
                <h:column>
                    <f:facet name="header">
                        Author
                    </f:facet>
                    <h:outputText value="#{posts.user.firstName}"/>
                </h:column>
                <h:column>
                    <f:facet name="header">
                        Post Date
                    </f:facet>
                    <h:outputText value="#{posts.postdate}"/>
                </h:column>
            </h:dataTable>
            <hr/>
            <h:dataTable var="posts" value="#{postController.allRegularPosts}"
                         styleClass="postcss"
                         rendered="#{subscriptionController.serviceType() == 'free' or 
                                     subscriptionController.serviceType() == 'standard'}">
                <h:column>
                    <f:facet name="header">
                    </f:facet>
                    <h:outputText value="#{posts.posttype.label}"/>
                </h:column>
                <h:column>
                    <f:facet name="header">
                    </f:facet>
                    <h:link value="#{posts.subject}" outcome="postdetail?pid=#{posts.id}"/>
                </h:column>
                <h:column>
                    <f:facet name="header">

                    </f:facet>
                    <h:outputText value="#{posts.user.firstName}"/>
                </h:column>
                <h:column>
                    <f:facet name="header">
                    </f:facet>
                    <h:outputText value="#{posts.postdate}"/>
                </h:column>
            </h:dataTable>
            <h:button value="Export post record" outcome="/faces/user/exportedRecord?faces-redirect=true"/>
        </ui:define>
    </ui:composition>
</html>

